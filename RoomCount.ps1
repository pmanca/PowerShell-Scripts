cls
#This is the First of the to scripts run to count the rooms and suites for Marriott for the year end billing
#the second script is called RoomCountColumn
#Peter Manca


<#

NOTE!!!!

There is a small bug that will need to be worked through for jan 2017

There are some all suite hotels that won't appear.  A new Pattern will have to be made for this

EX. Here is an example of 3 in a row

no match 14 floors 371 suites 
no match 13 meeting rooms, 22,219 sq ft of total meeting space 
no match 11 floors 253 suites 
no match 5 meeting rooms, 3,200 sq ft of total meeting space 
no match 11 floors 272 suites 
no match 10 meeting rooms, 8,610 sq ft of total meeting space 

SHould be a pattern made for just floors and suites as there is one for floors and rooms

#>



$marsha = @("BUFBD",
"SEAMB",
"OAKDT",
"ABEBR",
"AUSJW",
"CHIDM",
"JAXSW",
"DENDR",
"PHFOY",
"WASCO",
"YEGBR",
"BUFNY",
"SBASY",
"PIAMC",
"PFNLE",
"LITPB",
"BNAGO",
"MEMMM",
"BNAGI",
"DALGT",
"MSPNW",
"WASGN",
"MCOGP",
"SDFLS",
"PHXTM",
"CHIMN",
"PHXBD",
"YOWMC",
"YYZBR",
"BTRBB",
"FLLBP",
"CSGAK",
"SLCVO",
"PVDBR",
"DTTTT",
"ATLBD",
"IAGMC",
"WASPY",
"INDJW",
"STLWE",
"CHIJW",
"MIAMJ",
"AUSAP",
"DALDT",
"NYCAK",
"ATLMA",
"MSPAK",
"MCOLR",
"DTWDN",
"LAXLZ",
"LAXJW",
"PBISN",
"PSPBR",
"SATJW",
"RSWSB",
"ATLBC",
"BMIMC",
"LAXWC",
"LASJW",
"MCNFS",
"YULMA",
"EWRWD",
"BOSPP",
"AIYFW",
"DTWPO",
"PWMAP",
"MRKML",
"YYJMC",
"PSMWW",
"RDURN",
"EYWMC",
"YQAJW",
"PHFVI",
"SGFHB",
"BFLMC",
"WHRVI",
"QKBVI",
"RDUMC",
"RNOTL",
"PBIPS",
"SNAAV",
"OAKMC",
"YVRSA",
"SFOUS",
"CHIRH",
"PHXST",
"MSYBR",
"MSYDT",
"DFWMC",
"SFOFW",
"MCOSR",
"HOUWL",
"MKEMW",
"MSPDD",
"MGMBR",
"BOSWF",
"WASUM",
"EWRNR",
"NYCBR",
"CLEAP",
"PHXGR",
"GRRJW",
"CHSBR",
"MOBBR",
"MSYMM",
"CLTRP",
"GSPAP",
"HHHVI",
"CSGAB",
"CHSMC",
"MGMMM",
"BDRCT",
"BURAP",
"CVGKG",
"YEGMC",
"MOBRV",
"SLCMS",
"SLCVI",
"PTLAL",
"CIDIC",
"CHIRS",
"SFOJW",
"OXRVB",
"SNADP",
"CLTPH",
"YHZMC",
"WASRW",
"AGSMC",
"DALWL",
"IADMC",
"MCOAP",
"PITMC",
"LIHWI",
"HNLKO",
"LASVG",
"TTNDF",
"INTMC",
"BHMHV",
"MSYMC",
"MSLMC",
"MSPSP",
"MCOCY",
"DALBR",
"DALMT",
"SDFLM",
"CAEMH",
"LAXRR",
"LAXMN",
"CHIBR",
"LNKFS",
"SANGL",
"TUSSP",
"LASBR",
"SFOLS",
"WASBN",
"CHIST",
"TPAIM",
"ATLPC",
"LAXNC",
"CTDSR",
"BOSCB",
"SEAMC",
"MYROW",
"HOUWM",
"CMHBR",
"NYCRT",
"PHXCV",
"BWIAP",
"BWIBU",
"DALPT",
"DALQC",
"HPNSH",
"AUSSH",
"TPASR",
"YVRDT",
"PBIMC",
"MCOGV",
"MCOJW",
"MCORZ",
"SJCSJ",
"BDLMA",
"SOSBW",
"MSYJW",
"HOUMW",
"SANDM",
"SNAAS",
"SEAWF",
"STLDT",
"PHXDR",
"LAXMB",
"NPBST",
"BOSBU",
"INDCC",
"LAXIR",
"DENWE",
"FTCCO",
"BOSQU",
"MCOLY",
"BWIWF",
"BWIIH",
"WASGB",
"LAXAP",
"CLEBR",
"LIHHI",
"CTDDS",
"YYZOT",
"YYZEC",
"PHLWE",
"WASDT",
"MIAJW",
"MIAMB",
"BOSPB",
"EWRHO",
"EWRBR",
"WASBT",
"WASMC",
"YYCDT",
"DENDT",
"EWRGP",
"WASWE",
"SEAWA",
"LAXAH",
"LAXNB",
"LAXTR",
"WASKB",
"DTWLI",
"HOUJW",
"ATLAW",
"ATLJW",
"ATLNE",
"MSYLA",
"ATLSA",
"ATLRB",
"WASRB",
"DAYOH",
"TPAMC",
"EWRPR",
"WASWG",
"SLCUT",
"WASFP",
"CHISR",
"LASST",
"PHXCB",
"SANCI",
"BWISH",
"OAKSR",
"ORFGR",
"LGAAP",
"PSPSR",
"SJUPR",
"DSMIA",
"HNMMH",
"NYCWE",
"RICDT",
"MSPCC",
"SJCFM",
"DFWDT",
"DTWDT",
"IADWF",
"PDXOR",
"SANLJ",
"MCIAP",
"PHLDT",
"CLESC",
"MRKFL",
"SANDT",
"MRYCA",
"SNAST",
"ATLEG",
"CHIDG",
"CHIOB",
"WASCC",
"WASGW",
"WASSB",
"BOSNT",
"NYCEA",
"NYCMQ",
"PVDLW",
"CTDCA",
"PHXNO",
"MSPWE",
"STLSA",
"DTWDI",
"WASTC",
"MIADD",
"DENTC",
"HOUMC",
"IAHAP",
"WHRCO",
"BNASH",
"BNATN",
"DFWAP",
"SATDT",
"SATRC",
"SFOBG",
"SFODT",
"SJCGA",
"MCOWC",
"TPAAP",
"CHIAP",
"CHIDS",
"LEXKY",
"CHIDT",
"CHILN",
"CHISB",
"ATLAP",
"STLAP",
"CRWWV",
"MCIOP",
"TRICC",
"SANMV",
"CLTCC",
"GSONC",
"RDUNC",
"ATLCP",
"ATLMQ",
"ATLMS",
"FLLSB",
"MIAAP",
"MIABB",
"BOSCO",
"WASSH",
"ATLNO",
"PHLAR",
"EWRAP",
"WASJW",
"IADAP",
"IADDS",
"BOSLW",
"NYCLI",
"NYCBK",
"NYCWS"


)


$pattern = "\d* floors , (\d*) rooms.*"
$pattern2 = "\d* floors , (\d*) rooms , (\d*) suites.*"
function Get-RoomCount {
    param($marshaCode)

    $url = "www.marriott.com/hotels/fact-sheet/travel/$marshaCode&resetBN=true"

    $result = Invoke-WebRequest $url

    $result.AllElements | 
        Where Class -eq "cs-custom-list t-toggle-container" |
        Select -Skip 1 -First 1  -ExpandProperty innerText 
            
}


for($i = 0; $i -lt $marsha.Length; $i++){

    Add-Content -Value $marsha[$i] -Path "C:\test\roomcount.txt"
    Get-RoomCount $marsha[$i]|Out-File "C:\test\roomcountTemp.txt"

    Get-Content -Path "C:\test\roomcountTemp.txt"|

    ForEach-Object{
        if($_ -match $pattern){
            $roomTemp = $Matches[1]
            if($_ -match $pattern2){
               $roomTemp = $Matches[1]
               $suiteTemp = $Matches[2]
                Add-Content -value "$roomTemp  rooms" -Path "C:\test\roomcount.txt"
                Add-Content -value "$suiteTemp suites" -Path "C:\test\roomcount.txt"
            }else{
                Add-Content -Value "$roomTemp  rooms" -Path "C:\test\roomcount.txt"
                Write-Host $marsha[$i]
            }
    
        } else{
            Write-Host "no match" $_
        }



    }
}